{"version":3,"file":"static/js/23.55ccff4a.chunk.js","mappings":"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","sources":["metrimoniul/component/payment/StripePaymentModal.jsx","metrimoniul/pagesMetrimoniul/membership.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { loadStripe } from \"@stripe/stripe-js\";\r\nimport {\r\n  Elements,\r\n  PaymentElement,\r\n  useStripe,\r\n  useElements,\r\n} from \"@stripe/react-stripe-js\";\r\nimport { createPaymentIntent, confirmPayment } from \"../../../service/MANAGE_API/paymentService\";\r\nimport toast from \"react-hot-toast\";\r\nimport \"./StripePaymentModal.css\";\r\n\r\n// Initialize Stripe with your publishable key\r\nconst stripePublishableKey = process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY;\r\n\r\nif (!stripePublishableKey) {\r\n  console.error(\"STRIPE KEY ERROR: REACT_APP_STRIPE_PUBLISHABLE_KEY is not defined in .env file\");\r\n}\r\n\r\nconst stripePromise = stripePublishableKey ? loadStripe(stripePublishableKey) : null;\r\n\r\nconst CheckoutForm = ({ clientSecret, amount, onSuccess, onCancel, userId }) => {\r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const [errorMessage, setErrorMessage] = useState(null);\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n\r\n    if (!stripe || !elements) {\r\n      return;\r\n    }\r\n\r\n    setIsProcessing(true);\r\n    setErrorMessage(null);\r\n\r\n    try {\r\n      const { error, paymentIntent } = await stripe.confirmPayment({\r\n        elements,\r\n        confirmParams: {\r\n          return_url: window.location.origin + \"/payment-success\",\r\n        },\r\n        redirect: \"if_required\",\r\n      });\r\n\r\n      if (error) {\r\n        setErrorMessage(error.message);\r\n        toast.error(error.message);\r\n      } else if (paymentIntent && paymentIntent.status === \"succeeded\") {\r\n        \r\n        try {\r\n          const confirmResponse = await confirmPayment(paymentIntent.id, userId);\r\n          \r\n          if (confirmResponse.isSuccess) {\r\n            const { payment, coinsAwarded, newBalance } = confirmResponse.data;\r\n            \r\n            // Show success message with subscription details\r\n            toast.success(\r\n              `Payment successful! ${coinsAwarded} coins awarded. New balance: ${newBalance}`,\r\n              { duration: 5000 }\r\n            );\r\n            \r\n           \r\n            \r\n            onSuccess(paymentIntent, confirmResponse.data);\r\n          } else {\r\n            toast.error(\"Payment processed but failed to activate subscription. Please contact support.\");\r\n            onSuccess(paymentIntent, null);\r\n          }\r\n        } catch (confirmError) {\r\n          console.error(\"Failed to confirm payment:\", confirmError);\r\n          toast.error(\"Payment successful but failed to activate subscription. Please contact support.\");\r\n          onSuccess(paymentIntent, null);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      setErrorMessage(\"An unexpected error occurred.\");\r\n      toast.error(\"Payment failed. Please try again.\");\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"stripe-payment-form\">\r\n      <div className=\"payment-amount\">\r\n        <h3>Payment Amount: ${amount}</h3>\r\n      </div>\r\n\r\n      <PaymentElement />\r\n\r\n      {errorMessage && (\r\n        <div className=\"error-message\" style={{ color: \"red\", marginTop: \"10px\" }}>\r\n          {errorMessage}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"payment-buttons\">\r\n        <button\r\n          type=\"submit\"\r\n          disabled={!stripe || isProcessing}\r\n          className=\"btn-pay\"\r\n        >\r\n          {isProcessing ? \"Processing...\" : `Pay $${amount}`}\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          onClick={onCancel}\r\n          className=\"btn-cancel\"\r\n          disabled={isProcessing}\r\n        >\r\n          Cancel\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nconst StripePaymentModal = ({ isOpen, onClose, subscriptionPlan, userId }) => {\r\n  const [clientSecret, setClientSecret] = useState(null);\r\n  const [paymentData, setPaymentData] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    \r\n    if (isOpen && subscriptionPlan && userId) {\r\n      initializePayment();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [isOpen, subscriptionPlan, userId]);\r\n\r\n  const initializePayment = async () => {\r\n    setLoading(true);\r\n    \r\n    try {\r\n      const response = await createPaymentIntent(userId, subscriptionPlan);\r\n      \r\n      if (response.isSuccess) {\r\n        setClientSecret(response.data.clientSecret);\r\n        setPaymentData(response.data);\r\n      } else {\r\n        console.error(\"Payment initialization failed:\", response);\r\n        toast.error(\"Failed to initialize payment\");\r\n      }\r\n    } catch (error) {\r\n      toast.error(\"Error initializing payment. Please try again.\");\r\n      console.error(\"Payment initialization error:\", error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSuccess = (paymentIntent, confirmationData) => {\r\n\r\n    \r\n    setTimeout(() => {\r\n      onClose(true, confirmationData); // Pass success and confirmation data\r\n    }, 2000);\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    onClose(false);\r\n  };\r\n\r\n  if (!isOpen) {\r\n    return null;\r\n  }\r\n\r\n\r\n  const options = {\r\n    clientSecret,\r\n    appearance: {\r\n      theme: \"stripe\",\r\n      variables: {\r\n        colorPrimary: \"#0570de\",\r\n        colorBackground: \"#ffffff\",\r\n        colorText: \"#30313d\",\r\n        colorDanger: \"#df1b41\",\r\n        fontFamily: \"system-ui, sans-serif\",\r\n        spacingUnit: \"4px\",\r\n        borderRadius: \"8px\",\r\n      },\r\n    },\r\n  };\r\n\r\n  return (\r\n    <div className=\"payment-modal-overlay\">\r\n      <div className=\"payment-modal\">\r\n        <div className=\"payment-modal-header\">\r\n          <h2>Complete Your Payment</h2>\r\n          <button className=\"close-btn\" onClick={handleCancel}>\r\n            &times;\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"payment-modal-body\">\r\n          {loading && (\r\n            <div className=\"loading-spinner\">\r\n              <p>Initializing payment...</p>\r\n            </div>\r\n          )}\r\n\r\n          {!loading && clientSecret && (\r\n            <Elements stripe={stripePromise} options={options}>\r\n              <CheckoutForm\r\n                clientSecret={clientSecret}\r\n                amount={paymentData?.amount || 0}\r\n                onSuccess={handleSuccess}\r\n                onCancel={handleCancel}\r\n                userId={userId}\r\n              />\r\n            </Elements>\r\n          )}\r\n\r\n          {!loading && !clientSecret && (\r\n            <div className=\"error-state\">\r\n              <p>Unable to initialize payment. Please try again.</p>\r\n              <button onClick={handleCancel} className=\"btn-cancel\">\r\n                Close\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StripePaymentModal;\r\n\r\n","import { Component, Fragment } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport FooterFour from \"../component/layout/footerFour\";\r\nimport HeaderFour from \"../component/layout/HeaderFour\";\r\nimport StripePaymentModal from \"../component/payment/StripePaymentModal\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nconst title = \"Membership Levels\";\r\nconst subtitle =\r\n  \"Our metrimony platform is like a breath of fresh air. Clean and trendy design with ready to use features we are sure you will love.\";\r\n\r\nlet MembershipList = [\r\n  {\r\n    daycount: \"Silver\",\r\n    perMonth: \"$15.00 Now And Then $30.00 Per Month.\",\r\n    price: \"$20.00\",\r\n    btnText: \"Select Plan\",\r\n    faciList: [\r\n      {\r\n        iconName: \"fa-solid fa-circle-check\",\r\n        text: \"View Members Directory\",\r\n      },\r\n      {\r\n        iconName: \"fa-solid fa-circle-check\",\r\n        text: \"View Members Profile\",\r\n      },\r\n      {\r\n        iconName: \"fa-solid fa-circle-check\",\r\n        text: \"Send Private Messages\",\r\n      },\r\n      {\r\n        iconName: \"fa-solid fa-circle-xmark\",\r\n        text: \"Add Media To Your Profile\",\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    daycount: \"Gold\",\r\n    perMonth: \"$15.00 Now And Then $30.00 Per Month.\",\r\n    price: \"$30.00\",\r\n    btnText: \"Select Plan\",\r\n    faciList: [\r\n      {\r\n        iconName: \"fa-solid fa-circle-check\",\r\n        text: \"View Members Directory\",\r\n      },\r\n      {\r\n        iconName: \"fa-solid fa-circle-check\",\r\n        text: \"View Members Profile\",\r\n      },\r\n      {\r\n        iconName: \"fa-solid fa-circle-check\",\r\n        text: \"Send Private Messages\",\r\n      },\r\n      {\r\n        iconName: \"fa-solid fa-circle-check\",\r\n        text: \"Add Media To Your Profile\",\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\nlet coinsPlan = [\r\n  {\r\n    daycount: \"Choose you best coin plan\",\r\n    perMonth: \"Elevate connections with our premier Best Coin Plan!\",\r\n    price: \"Free\",\r\n    btnText: \"Select Plan\",\r\n    faciList: [\r\n      {\r\n        iconName: \"fa-solid fa-circle-check\",\r\n        text: \"5 coins $8.99\",\r\n        offer: \"save 45%\",\r\n      },\r\n      {\r\n        iconName: \"fa-solid fa-circle-check\",\r\n        text: \"30 coins $37.99\",\r\n        offer: \"best value\",\r\n      },\r\n      {\r\n        iconName: \"fa-solid fa-circle-check\",\r\n        text: \"15 coins $22.99\",\r\n        offer: \"save 48%\",\r\n      },\r\n      {\r\n        iconName: \"fa-solid fa-circle-check\",\r\n        text: \"2 coins $2.99\",\r\n        offer: \"small plan\",\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\nclass MembershipPage extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      selectedCoinPlan: null,\r\n      isPaymentModalOpen: false,\r\n      selectedPlan: null,\r\n      userId: null,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Get userId from localStorage, Redux store, or wherever you store user data\r\n    // This is a placeholder - adjust according to your auth implementation\r\n    const userId = JSON.parse(localStorage.getItem(\"userData\"))?.data?._id;\r\n    this.setState({ userId });\r\n    console.log(\"Metrimonial Membership Page Loaded - User ID:\", userId);\r\n  }\r\n\r\n  handleSelectPlan = (index) => {\r\n    this.setState({ selectedCoinPlan: index });\r\n  };\r\n\r\n  handleSubscriptionClick = (planName, e) => {\r\n    if (e) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n    \r\n    const { userId } = this.state;\r\n    \r\n    console.log(\"Subscription clicked:\", planName);\r\n    console.log(\"User ID:\", userId);\r\n    \r\n    if (!userId) {\r\n      toast.error(\"Please login to subscribe\");\r\n      return;\r\n    }\r\n\r\n    console.log(\"Opening payment modal for:\", planName.toLowerCase());\r\n    \r\n    this.setState({\r\n      isPaymentModalOpen: true,\r\n      selectedPlan: planName.toLowerCase(),\r\n    }, () => {\r\n      console.log(\"Modal state updated:\", this.state.isPaymentModalOpen);\r\n      console.log(\"Selected plan:\", this.state.selectedPlan);\r\n    });\r\n  };\r\n\r\n  handlePaymentModalClose = (success, confirmationData) => {\r\n    console.log(\"Payment modal closing - Success:\", success);\r\n    console.log(\"Confirmation data:\", confirmationData);\r\n    \r\n    this.setState({ isPaymentModalOpen: false, selectedPlan: null });\r\n    \r\n    if (success && confirmationData) {\r\n      const { payment, coinsAwarded, newBalance } = confirmationData;\r\n      \r\n      // Show detailed success message\r\n      toast.success(\r\n        `ðŸŽ‰ Welcome to ${payment.subscriptionPlan.toUpperCase()} plan!\\n` +\r\n        `ðŸ’° ${coinsAwarded} coins added to your account\\n` +\r\n        `ðŸ“Š New balance: ${newBalance} coins\\n` +\r\n        `ðŸ“… Valid until: ${new Date(payment.subscriptionEndDate).toLocaleDateString()}`,\r\n        { duration: 8000 }\r\n      );\r\n      \r\n      // You can add additional logic here like:\r\n      // - Redirect to profile page\r\n      // - Update user subscription in Redux/Context\r\n      // - Refresh user data\r\n      // - Show a welcome modal with subscription details\r\n      \r\n      console.log(\"Subscription Details:\", {\r\n        plan: payment.subscriptionPlan,\r\n        amount: payment.amount,\r\n        coinsAwarded,\r\n        newBalance,\r\n        startDate: payment.subscriptionStartDate,\r\n        endDate: payment.subscriptionEndDate\r\n      });\r\n    } else if (success) {\r\n      toast.success(\"Payment successful! Your subscription has been activated.\");\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { selectedCoinPlan, isPaymentModalOpen, selectedPlan, userId } = this.state;\r\n    return (\r\n      <Fragment>\r\n        <HeaderFour />\r\n        \r\n        <StripePaymentModal\r\n          isOpen={isPaymentModalOpen}\r\n          onClose={this.handlePaymentModalClose}\r\n          subscriptionPlan={selectedPlan}\r\n          userId={userId}\r\n        />\r\n\r\n        <div className=\"membership padding-top padding-bottom\">\r\n  <div className=\"container\" style={{maxWidth:'1358px'}}>\r\n    <div className=\"section__header style-2 text-center\">\r\n      <h2>{title}</h2>\r\n      <p>{subtitle}</p>\r\n    </div>\r\n    <div className=\"section__wrapper\">\r\n              <div className=\"row g-4 justify-content-center row-cols-xl-4 row-cols-lg-3 row-cols-sm-2 row-cols-1\">\r\n                {coinsPlan.map((val, i) => (\r\n                  <div\r\n                    className={`col ${\r\n                      selectedCoinPlan === i ? \"selected-coin-plan\" : \"\"\r\n                    }`}\r\n                    key={i}\r\n                    //    style={{ width: '35%' }}\r\n                    onClick={() => this.handleSelectPlan(i)}\r\n                  >\r\n                    <div className=\"membership__item\">\r\n                      <div className=\"membership__inner\">\r\n                        <div className=\"membership__head\">\r\n                          <h4>{val.daycount}</h4>\r\n                          <p>{val.perMonth}</p>\r\n                        </div>\r\n                        <div className=\"membership__body\">\r\n                          <ul>\r\n                            {val.faciList.map((val, i) => (\r\n                              <li key={i} className=\"pointer\" style={{paddingTop:'21px',paddingBottom:'21px'}}>\r\n                                <i className={val.iconName} ></i>\r\n                                <span className=\"px-2\">{val.text}</span>\r\n                                <span className=\"px-2\">{val.offer}</span>\r\n                                <img\r\n                                  src=\"https://png.pngtree.com/png-clipart/20220823/original/pngtree-flying-gold-coin-png-png-image_8447452.png\"\r\n                                  alt=\"\"\r\n                                  style={{ width: \"90px\", height: \"45px\" }}\r\n                                />\r\n                              </li>\r\n                            ))}\r\n                          </ul>\r\n                        </div>\r\n                        <div className=\"membership__footer\">\r\n                          <button \r\n                            type=\"button\"\r\n                            className=\"default-btn reverse\" \r\n                            style={{ border: 'none', width: '100%', cursor: 'pointer' }}\r\n                            onClick={() => toast.info(\"Coin plans coming soon!\")}\r\n                          >\r\n                            <span>{val.btnText}</span>\r\n                          </button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n                {MembershipList.map((val, i) => (\r\n                  <div className=\"col\" key={i}>\r\n                    <div className=\"membership__item\">\r\n                      <div className=\"membership__inner\">\r\n                        <div className=\"membership__head\">\r\n                          <h4>{val.daycount}</h4>\r\n                          <p>{val.perMonth}</p>\r\n                        </div>\r\n                        <div className=\"membership__body\">\r\n                          <h4>{val.price}</h4>\r\n                          <ul>\r\n                            {val.faciList.map((val, i) => (\r\n                              <li key={i}>\r\n                                <i className={val.iconName}></i>{\" \"}\r\n                                <span>{val.text}</span>\r\n                              </li>\r\n                            ))}\r\n                          </ul>\r\n                        </div>\r\n                        <div className=\"membership__footer\">\r\n                          <button \r\n                            type=\"button\"\r\n                            className=\"default-btn reverse\" \r\n                            style={{ border: 'none', width: '100%', cursor: 'pointer' }}\r\n                            onClick={(e) => this.handleSubscriptionClick(val.daycount, e)}\r\n                          >\r\n                            <span>{val.btnText}</span>\r\n                          </button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n  </div>\r\n\r\n<div className=\"purchase_history_wrap\">\r\n  \r\n</div>\r\n\r\n</div>\r\n\r\n        <FooterFour />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MembershipPage;\r\n"],"names":["stripePublishableKey","process","stripePromise","loadStripe","CheckoutForm","_ref","clientSecret","amount","onSuccess","onCancel","userId","stripe","useStripe","elements","useElements","isProcessing","setIsProcessing","useState","errorMessage","setErrorMessage","_jsxs","onSubmit","async","event","preventDefault","error","paymentIntent","confirmPayment","confirmParams","return_url","window","location","origin","redirect","message","toast","status","confirmResponse","id","isSuccess","payment","coinsAwarded","newBalance","data","success","concat","duration","confirmError","console","err","className","children","_jsx","PaymentElement","style","color","marginTop","type","disabled","onClick","_ref2","isOpen","onClose","subscriptionPlan","setClientSecret","paymentData","setPaymentData","loading","setLoading","useEffect","initializePayment","response","createPaymentIntent","handleCancel","options","appearance","theme","variables","colorPrimary","colorBackground","colorText","colorDanger","fontFamily","spacingUnit","borderRadius","Elements","handleSuccess","confirmationData","setTimeout","MembershipList","daycount","perMonth","price","btnText","faciList","iconName","text","coinsPlan","offer","MembershipPage","Component","constructor","props","super","handleSelectPlan","index","this","setState","selectedCoinPlan","handleSubscriptionClick","planName","e","stopPropagation","state","log","toLowerCase","isPaymentModalOpen","selectedPlan","handlePaymentModalClose","toUpperCase","Date","subscriptionEndDate","toLocaleDateString","plan","startDate","subscriptionStartDate","endDate","componentDidMount","_JSON$parse","_JSON$parse$data","JSON","parse","localStorage","getItem","_id","render","Fragment","HeaderFour","StripePaymentModal","maxWidth","map","val","i","paddingTop","paddingBottom","src","alt","width","height","border","cursor","info","FooterFour"],"sourceRoot":""}